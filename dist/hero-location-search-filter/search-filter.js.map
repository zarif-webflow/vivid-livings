{
  "version": 3,
  "sources": ["../../src/features/hero-location-search-filter/search-filter.ts"],
  "sourcesContent": ["import { getHtmlElement } from \"@taj-wf/utils\";\r\n\r\nimport type { ListFilterCondition } from \"@/types/finsweet-attributes-list\";\r\nimport { generateSearchQueryParams, getAppliedFilters } from \"@/utils/finsweet-list-helpers\";\r\n\r\nconst fsListInstanceNames = {\r\n  buy: \"property-buy-search\",\r\n  rent: \"property-rent-search\",\r\n  offplan: \"offplan-search\",\r\n};\r\n\r\nconst fsListFieldNames = {\r\n  buy: \"location\",\r\n  rent: \"location\",\r\n  offplan: \"name-with-location\",\r\n};\r\n\r\nconst configs = {\r\n  buy: {\r\n    pageSlug: \"buy\",\r\n    fsListInstanceName: fsListInstanceNames.buy,\r\n    selectors: {\r\n      locationSearchInput: `[fs-list-instance=${fsListInstanceNames.buy}] input[combobox-input=${fsListFieldNames.buy}][data-input-combobox=input]`,\r\n      searchButton: `[fs-list-instance=${fsListInstanceNames.buy}] form button[data-search-button=true]`,\r\n    },\r\n    fieldName: fsListFieldNames.buy,\r\n  },\r\n  rent: {\r\n    pageSlug: \"rent\",\r\n    fsListInstanceName: fsListInstanceNames.rent,\r\n    selectors: {\r\n      locationSearchInput: `[fs-list-instance=${fsListInstanceNames.rent}] input[combobox-input=${fsListFieldNames.rent}][data-input-combobox=input]`,\r\n      searchButton: `[fs-list-instance=${fsListInstanceNames.rent}] form button[data-search-button=true]`,\r\n    },\r\n    fieldName: fsListFieldNames.rent,\r\n  },\r\n  offplan: {\r\n    pageSlug: \"off-plan\",\r\n    fsListInstanceName: fsListInstanceNames.offplan,\r\n    selectors: {\r\n      locationSearchInput: `[fs-list-instance=${fsListInstanceNames.offplan}] input[combobox-input=${fsListFieldNames.offplan}][data-input-combobox=input]`,\r\n      searchButton: `[fs-list-instance=${fsListInstanceNames.offplan}] form button[data-search-button=true]`,\r\n    },\r\n    fieldName: fsListFieldNames.offplan,\r\n  },\r\n};\r\n\r\nconst initSearchFilter = ({\r\n  fsListInstanceName,\r\n  pageSlug,\r\n  selectors: SELECTORS,\r\n  fieldName,\r\n}: (typeof configs)[keyof typeof configs]) => {\r\n  const locationSearchInput = getHtmlElement<HTMLComboboxInputElement>({\r\n    selector: SELECTORS.locationSearchInput,\r\n  });\r\n\r\n  if (!locationSearchInput) {\r\n    console.error(\"Location search input not found\", SELECTORS.locationSearchInput);\r\n    return;\r\n  }\r\n\r\n  const searchButton = getHtmlElement<HTMLButtonElement>({\r\n    selector: SELECTORS.searchButton,\r\n  });\r\n\r\n  if (!searchButton) {\r\n    console.error(\"Search button not found\", SELECTORS.searchButton);\r\n    return;\r\n  }\r\n\r\n  let searchParamsPrefix = locationSearchInput.getAttribute(\"data-search-params-prefix\");\r\n  if (!searchParamsPrefix) {\r\n    console.debug(\"Search params prefix not found, using default value\");\r\n    searchParamsPrefix = \"\";\r\n  }\r\n\r\n  let listFilterConditions: ListFilterCondition[] = [];\r\n  //   let listInstance: ListInstance | undefined = undefined;\r\n\r\n  window.FinsweetAttributes ||= [];\r\n  window.FinsweetAttributes.push([\r\n    \"list\",\r\n    (instances) => {\r\n      for (const instance of instances) {\r\n        if (instance.instance !== fsListInstanceName) continue;\r\n\r\n        const appliedFilters = getAppliedFilters(instance);\r\n        listFilterConditions = appliedFilters;\r\n      }\r\n    },\r\n  ]);\r\n\r\n  searchButton.addEventListener(\"click\", () => {\r\n    let query = generateSearchQueryParams(listFilterConditions, searchParamsPrefix);\r\n    const locationValue = locationSearchInput.value.trim();\r\n\r\n    const finalSearchParamsPrefix = searchParamsPrefix ? searchParamsPrefix + \"_\" : \"\";\r\n\r\n    if (locationValue) {\r\n      query +=\r\n        (query ? \"&\" : \"?\") +\r\n        `${encodeURIComponent(`${finalSearchParamsPrefix}${fieldName}_equal`)}=${encodeURIComponent(locationValue)}`;\r\n    }\r\n\r\n    const baseUrl = window.location.origin;\r\n\r\n    const fullUrl = `${baseUrl}/${pageSlug}${query}`;\r\n\r\n    window.location.href = fullUrl;\r\n  });\r\n};\r\n\r\nconst init = () => {\r\n  initSearchFilter(configs.buy);\r\n  initSearchFilter(configs.rent);\r\n  initSearchFilter(configs.offplan);\r\n};\r\n\r\ninit();\r\n"],
  "mappings": ";;;;;;;;;;;;AAAA;AAKA,IAAM,sBAAsB;AAAA,EAC1B,KAAK;AAAA,EACL,MAAM;AAAA,EACN,SAAS;AACX;AAEA,IAAM,mBAAmB;AAAA,EACvB,KAAK;AAAA,EACL,MAAM;AAAA,EACN,SAAS;AACX;AAEA,IAAM,UAAU;AAAA,EACd,KAAK;AAAA,IACH,UAAU;AAAA,IACV,oBAAoB,oBAAoB;AAAA,IACxC,WAAW;AAAA,MACT,qBAAqB,qBAAqB,oBAAoB,GAAG,0BAA0B,iBAAiB,GAAG;AAAA,MAC/G,cAAc,qBAAqB,oBAAoB,GAAG;AAAA,IAC5D;AAAA,IACA,WAAW,iBAAiB;AAAA,EAC9B;AAAA,EACA,MAAM;AAAA,IACJ,UAAU;AAAA,IACV,oBAAoB,oBAAoB;AAAA,IACxC,WAAW;AAAA,MACT,qBAAqB,qBAAqB,oBAAoB,IAAI,0BAA0B,iBAAiB,IAAI;AAAA,MACjH,cAAc,qBAAqB,oBAAoB,IAAI;AAAA,IAC7D;AAAA,IACA,WAAW,iBAAiB;AAAA,EAC9B;AAAA,EACA,SAAS;AAAA,IACP,UAAU;AAAA,IACV,oBAAoB,oBAAoB;AAAA,IACxC,WAAW;AAAA,MACT,qBAAqB,qBAAqB,oBAAoB,OAAO,0BAA0B,iBAAiB,OAAO;AAAA,MACvH,cAAc,qBAAqB,oBAAoB,OAAO;AAAA,IAChE;AAAA,IACA,WAAW,iBAAiB;AAAA,EAC9B;AACF;AAEA,IAAM,mBAAmB,CAAC;AAAA,EACxB;AAAA,EACA;AAAA,EACA,WAAW;AAAA,EACX;AACF,MAA8C;AAC5C,QAAM,sBAAsB,eAAyC;AAAA,IACnE,UAAU,UAAU;AAAA,EACtB,CAAC;AAED,MAAI,CAAC,qBAAqB;AACxB,YAAQ,MAAM,mCAAmC,UAAU,mBAAmB;AAC9E;AAAA,EACF;AAEA,QAAM,eAAe,eAAkC;AAAA,IACrD,UAAU,UAAU;AAAA,EACtB,CAAC;AAED,MAAI,CAAC,cAAc;AACjB,YAAQ,MAAM,2BAA2B,UAAU,YAAY;AAC/D;AAAA,EACF;AAEA,MAAI,qBAAqB,oBAAoB,aAAa,2BAA2B;AACrF,MAAI,CAAC,oBAAoB;AACvB,YAAQ,MAAM,qDAAqD;AACnE,yBAAqB;AAAA,EACvB;AAEA,MAAI,uBAA8C,CAAC;AAGnD,SAAO,uBAAuB,CAAC;AAC/B,SAAO,mBAAmB,KAAK;AAAA,IAC7B;AAAA,IACA,CAAC,cAAc;AACb,iBAAW,YAAY,WAAW;AAChC,YAAI,SAAS,aAAa,mBAAoB;AAE9C,cAAM,iBAAiB,kBAAkB,QAAQ;AACjD,+BAAuB;AAAA,MACzB;AAAA,IACF;AAAA,EACF,CAAC;AAED,eAAa,iBAAiB,SAAS,MAAM;AAC3C,QAAI,QAAQ,0BAA0B,sBAAsB,kBAAkB;AAC9E,UAAM,gBAAgB,oBAAoB,MAAM,KAAK;AAErD,UAAM,0BAA0B,qBAAqB,qBAAqB,MAAM;AAEhF,QAAI,eAAe;AACjB,gBACG,QAAQ,MAAM,OACf,GAAG,mBAAmB,GAAG,uBAAuB,GAAG,SAAS,QAAQ,CAAC,IAAI,mBAAmB,aAAa,CAAC;AAAA,IAC9G;AAEA,UAAM,UAAU,OAAO,SAAS;AAEhC,UAAM,UAAU,GAAG,OAAO,IAAI,QAAQ,GAAG,KAAK;AAE9C,WAAO,SAAS,OAAO;AAAA,EACzB,CAAC;AACH;AAEA,IAAM,OAAO,MAAM;AACjB,mBAAiB,QAAQ,GAAG;AAC5B,mBAAiB,QAAQ,IAAI;AAC7B,mBAAiB,QAAQ,OAAO;AAClC;AAEA,KAAK;",
  "names": []
}
