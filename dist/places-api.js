import{a as k}from"./chunks/chunk-EHF5TEVY.js";import{c as S,e as P}from"./chunks/chunk-ISN7ZXVF.js";function x(r,e,t,s){function o(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(n){try{u(s.next(n))}catch(h){a(h)}}function c(n){try{u(s.throw(n))}catch(h){a(h)}}function u(n){n.done?i(n.value):o(n.value).then(l,c)}u((s=s.apply(r,e||[])).next())})}function D(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var I,L;function F(){return L||(L=1,I=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var s,o,i;if(Array.isArray(e)){if(s=e.length,s!=t.length)return!1;for(o=s;o--!==0;)if(!r(e[o],t[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),s=i.length,s!==Object.keys(t).length)return!1;for(o=s;o--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[o]))return!1;for(o=s;o--!==0;){var a=i[o];if(!r(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}),I}var $=F(),M=D($),R="__googleMapsScriptId",d;(function(r){r[r.INITIALIZED=0]="INITIALIZED",r[r.LOADING=1]="LOADING",r[r.SUCCESS=2]="SUCCESS",r[r.FAILURE=3]="FAILURE"})(d||(d={}));var v=class r{constructor({apiKey:e,authReferrerPolicy:t,channel:s,client:o,id:i=R,language:a,libraries:l=[],mapIds:c,nonce:u,region:n,retries:h=3,url:p="https://maps.googleapis.com/maps/api/js",version:f}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=t,this.channel=s,this.client=o,this.id=i||R,this.language=a,this.libraries=l,this.mapIds=c,this.nonce=u,this.region=n,this.retries=h,this.url=p,this.version=f,r.instance){if(!M(this.options,r.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(r.instance.options)}`);return r.instance}r.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?d.FAILURE:this.done?d.SUCCESS:this.loading?d.LOADING:d.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){let e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,t)=>{this.loadCallback(s=>{s?t(s.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,t;if(document.getElementById(this.id)){this.callback();return}let s={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(s).forEach(i=>!s[i]&&delete s[i]),!((t=(e=window?.google)===null||e===void 0?void 0:e.maps)===null||t===void 0)&&t.importLibrary||(i=>{let a,l,c,u="The Google Maps JavaScript API",n="google",h="importLibrary",p="__ib__",f=document,g=window;g=g[n]||(g[n]={});let m=g.maps||(g.maps={}),A=new Set,y=new URLSearchParams,C=()=>a||(a=new Promise((w,E)=>x(this,void 0,void 0,function*(){var b;yield l=f.createElement("script"),l.id=this.id,y.set("libraries",[...A]+"");for(c in i)y.set(c.replace(/[A-Z]/g,j=>"_"+j[0].toLowerCase()),i[c]);y.set("callback",n+".maps."+p),l.src=this.url+"?"+y,m[p]=w,l.onerror=()=>a=E(Error(u+" could not load.")),l.nonce=this.nonce||((b=f.querySelector("script[nonce]"))===null||b===void 0?void 0:b.nonce)||"",f.head.append(l)})));m[h]?console.warn(u+" only loads once. Ignoring:",i):m[h]=(w,...E)=>A.add(w)&&C().then(()=>m[h](w,...E))})(s);let o=this.libraries.map(i=>this.importLibrary(i));o.length||o.push(this.importLibrary("core")),Promise.all(o).then(()=>this.callback(),i=>{let a=new ErrorEvent("error",{error:i});this.loadErrorCallback(a)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){let t=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${t} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},t)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}};var O=P(import.meta.url);if(!O)throw new Error("Search Address script element was not found!");var _=O.getAttribute("data-places-key");if(!_)throw new Error("Places API key was not found in the script element! Please set data-places-key attribute in the script.");var T=new v({apiKey:_,version:"weekly"}),q=r=>r.replaceAll(" - ",", ").replaceAll(" | ",", "),N=async()=>{let{AutocompleteSuggestion:r}=await T.importLibrary("places"),e=new Map;return{fetchAddresses:k(async(o,i)=>{let a=e.get(o);if(a!==void 0){i(a);return}try{let l={input:o,includedRegionCodes:["ae"],includedPrimaryTypes:["lodging","sublocality","apartment_complex","neighborhood","condominium_complex"]},c=await r.fetchAutocompleteSuggestions(l);console.clear(),c.suggestions.forEach(n=>{let h=n?.placePrediction.mainText?.text;if(!h)throw new Error("No main text found for suggestion");let p=q(h);console.log("-------"),console.log(p),console.log(n?.placePrediction?.types),console.log("--------------")});let u=c.suggestions.filter(n=>n.placePrediction!=null).map(n=>n.placePrediction.text.text);e.set(o,u),i(u)}catch(l){console.error("Something went wrong with places api:",l);let c=[];e.set(o,c),i(c)}},100)}},U=N(),K=async()=>{U.then(({fetchAddresses:r})=>{console.log("Autocompletetions Loaded Succesfully!");let e=S({selector:"[data-search-input]"});e&&e.addEventListener("input",()=>{let t=e.value;r(t,s=>{})})})};K();export{U as fetchAddresses};
