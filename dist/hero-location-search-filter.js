const g=n=>n.filters.value.groups?.[0]?.conditions??[],S=n=>n.map(i=>i.fields);function $(n,i){const a=i?i.endsWith("_")?i:`${i}_`:"",t=n.filter(({interacted:r,value:c})=>r===!0&&c!=null&&String(c).trim()!=="").map(({id:r,value:c})=>{const u=`${a}${r}`;return`${encodeURIComponent(u)}=${encodeURIComponent(String(c))}`});return t.length>0?`?${t.join("&")}`:""}function A(n,i,{signal:a}={}){let t=null;const r=function(...u){t!==null&&clearTimeout(t),!a?.aborted&&(t=setTimeout(()=>{n(...u),t=null},i))},c=function(){r.cancel()};return r.cancel=function(){t!==null&&(clearTimeout(t),t=null)},a?.addEventListener("abort",c,{once:!0}),r}const h=(n,i)=>{const a={locationSearchInput:`[fs-list-instance=${n}] input[fs-list-field=name-with-location][data-input-combobox=input]`,searchButton:`[fs-list-instance=${n}] form button[data-search-button=true]`},t=document.querySelector(a.locationSearchInput);if(!t){console.error("Location search input not found",a.locationSearchInput);return}const r=document.querySelector(a.searchButton);if(!r){console.error("Search button not found",a.searchButton);return}let c=t.getAttribute("data-search-params-prefix");c||(console.debug("Search params prefix not found, using default value"),c="");let u=t.comboboxApi,d=[],f=[],p;t.addEventListener("combobox-init",o=>{u=o.detail.api}),window.FinsweetAttributes||(window.FinsweetAttributes=[]),window.FinsweetAttributes.push(["list",o=>{for(const e of o)e.instance===n&&(p=e,e.addHook("filter",l=>{const s=S(l),b=[];for(const v of s){const m=v["name-with-location"]?.value;typeof m=="string"&&b.push(m)}return d=b,f=g(e),l}))}]);const w=A((o,e)=>{if(!o.trim()){e.renderResults([]),e.closeResultModal();return}e.renderResults(d),e.openResultModal()},200);t.addEventListener("input",()=>{if(!u){console.warn("Combobox API not found",t);return}const o=t.value;w(o,u)}),r.addEventListener("click",()=>{const o=$(f,c),e=`${window.location.origin}/${i}${o}`;window.location.href=e}),t.addEventListener("combobox-select",o=>{const e=o.detail.selectedValue,l=p?.filters.value.groups[0]?.conditions;if(l)for(const s of l)s.fieldKey==="name-with-location"&&(s.value=e)})},y=()=>{h("property-location-search","buy"),h("offplan-location-search","off-plan")};y();
