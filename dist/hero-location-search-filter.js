import{d as $}from"./chunks/combobox.js";const g=n=>n.filters.value.groups?.[0]?.conditions??[],S=n=>n.map(i=>i.fields);function A(n,i){const l=i?i.endsWith("_")?i:`${i}_`:"",t=n.filter(({interacted:r,value:c})=>r===!0&&c!=null&&String(c).trim()!=="").map(({id:r,value:c})=>{const u=`${l}${r}`;return`${encodeURIComponent(u)}=${encodeURIComponent(String(c))}`});return t.length>0?`?${t.join("&")}`:""}function I(n,i,{signal:l}={}){let t=null;const r=function(...u){t!==null&&clearTimeout(t),!l?.aborted&&(t=setTimeout(()=>{n(...u),t=null},i))},c=function(){r.cancel()};return r.cancel=function(){t!==null&&(clearTimeout(t),t=null)},l?.addEventListener("abort",c,{once:!0}),r}const h=(n,i)=>{const l={locationSearchInput:`[fs-list-instance=${n}] input[fs-list-field=name-with-location]${$.comboboxInput}`,searchButton:`[fs-list-instance=${n}] form button[data-search-button=true]`},t=document.querySelector(l.locationSearchInput);if(!t){console.error("Location search input not found",l.locationSearchInput);return}const r=document.querySelector(l.searchButton);if(!r){console.error("Search button not found",l.searchButton);return}let c=t.getAttribute("data-search-params-prefix");c||(console.debug("Search params prefix not found, using default value"),c="");let u=t.comboboxApi,d=[],f=[],p;t.addEventListener("combobox-init",o=>{u=o.detail.api}),window.FinsweetAttributes||(window.FinsweetAttributes=[]),window.FinsweetAttributes.push(["list",o=>{for(const e of o)e.instance===n&&(p=e,e.addHook("filter",a=>{const s=S(a),m=[];for(const v of s){const b=v["name-with-location"]?.value;typeof b=="string"&&m.push(b)}return d=m,f=g(e),a}))}]);const w=I((o,e)=>{if(!o.trim()){e.renderResults([]),e.closeResultModal();return}e.renderResults(d),e.openResultModal()},200);t.addEventListener("input",()=>{if(!u){console.warn("Combobox API not found",t);return}const o=t.value;w(o,u)}),r.addEventListener("click",()=>{const o=A(f,c),e=`${window.location.origin}/${i}${o}`;window.location.href=e}),t.addEventListener("combobox-select",o=>{const e=o.detail.selectedValue,a=p?.filters.value.groups[0]?.conditions;if(a)for(const s of a)s.fieldKey==="name-with-location"&&(s.value=e)})},x=()=>{h("property-location-search","buy"),h("offplan-location-search","off-plan")};x();
